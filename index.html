<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kinetic Typography with Pointing and Wave</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
  <script>
    let targetX, targetY;
    let waveAmplitude = 20;
    let textString = "Follow Me!";
    
    function setup() {
      createCanvas(windowWidth, windowHeight);
      textAlign(CENTER, CENTER);
      textSize(32);
      targetX = width / 2;
      targetY = height / 2;
      
      let btn = createButton("Enable Motion");
      btn.position(10, 10);
      btn.mousePressed(function() {
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
          DeviceOrientationEvent.requestPermission()
            .then(response => {
              if (response === 'granted') {
                console.log("Permission granted");
              }
            })
            .catch(console.error);
        }
      });
    }

    function draw() {
      background(255);
      fill(0);

      // Gradually move text toward the target point
      let moveSpeed = 0.05;
      let currentX = lerp(width / 2, targetX, moveSpeed);
      let currentY = lerp(height / 2, targetY, moveSpeed);

      // Draw each character of the text with wave effect
      for (let i = 0; i < textString.length; i++) {
        let x = currentX + i * 30 - (textString.length * 15); // Spread letters out
        let y = currentY + sin(frameCount * 0.1 + i) * waveAmplitude; // Wave effect
        text(textString[i], x, y);
      }
    }

    /* Kinetic Typography Logic */
    function deviceMoved() {
      // Adjust the wave amplitude based on device movement
      waveAmplitude = map(rotationX, -90, 90, 10, 40); // Change amplitude with device rotation
    }

    // Optional: Let the target point follow the mouse (or user's finger on touch devices)
    function mouseMoved() {
      targetX = mouseX;
      targetY = mouseY;
    }

    function touchMoved() {
      targetX = touchX;
      targetY = touchY;
      return false; // Prevent default scrolling on touch
    }
  </script>
</body>
</html>
